# Лабораторна робота №1: Створення програмної реалізації алгоритму шифрування DES

**Курс:** Безпека програмних та апаратних засобів
**Університет:** НУРЕ

## Зміст

1. [Опис проекту](#опис-проекту)
2. [Вимоги до завдання](#вимоги-до-завдання)
3. [Структура проекту](#структура-проекту)
4. [Встановлення та запуск](#встановлення-та-запуск)
5. [Функціональність](#функціональність)
6. [Технічна реалізація](#технічна-реалізація)
7. [Тестування](#тестування)
8. [Результати](#результати)

---

## Опис проекту

Даний проект містить повну програмну реалізацію алгоритму симетричного блокового шифрування **DES (Data Encryption Standard)** без використання готових криптографічних бібліотек.

### Що таке DES?

DES - це симетричний блоковий шифр, розроблений у 1970-х роках компанією IBM на основі алгоритму Lucifer. Був офіційним стандартом шифрування США з 1977 по 2001 рік.

**Основні характеристики:**
- **Розмір блоку:** 64 біти (8 байт)
- **Довжина ключа:** 56 біт (8 байт з урахуванням контрольних біт)
- **Кількість раундів:** 16
- **Тип структури:** Мережа Фейстеля

---

## Вимоги до завдання

1. ✅ Створити програмну реалізацію алгоритму шифрування DES (без використання готових функцій)
2. ✅ Зробити перевірку на виключення слабких ключів
3. ✅ На кожному раунді мережі Фейстеля визначити ентропію появи біту, що дорівнює 1
4. ✅ Створити приємний та зрозумілий інтерфейс для перевірки зробленої роботи
5. ✅ Сформувати звіт в електронному вигляді

---

## Структура проекту

```
lab1/
├── docs/
│   └── Лб№1 DES.docx          # Опис лабораторної роботи
├── src/
│   ├── des.py                  # Основна реалізація алгоритму DES
│   ├── des_tables.py           # Константи та таблиці DES
│   ├── gui.py                  # Графічний інтерфейс користувача
│   └── test_des.py             # Набір тестів
└── README.md                   # Документація проекту
```

---

## Встановлення та запуск

### Вимоги

- Python 3.7+
- tkinter (зазвичай встановлений разом з Python)
- matplotlib (для відображення графіків)

### Встановлення залежностей

```bash
pip install matplotlib
```

### Запуск програми

#### 1. Запуск GUI інтерфейсу:

```bash
cd lab1/src
python3 gui.py
```

#### 2. Запуск консольної версії:

```bash
cd lab1/src
python3 des.py
```

#### 3. Запуск тестів:

```bash
cd lab1/src
python3 test_des.py
```

---

## Функціональність

### 1. Шифрування та розшифрування

Програма дозволяє:
- Шифрувати текстові дані з використанням 64-бітного ключа
- Розшифровувати зашифровані дані
- Працювати з текстом довільної довжини (автоматичне доповнення до кратності 8 байт)

### 2. Перевірка слабких ключів

Реалізована перевірка на три типи слабких ключів:
- **Weak keys (4 ключі)** - всі підключі однакові
- **Semi-weak keys (12 ключів)** - пари ключів, які є зворотними один до одного
- **Possibly weak keys (48 ключів)** - створюють лише 4 різних підключі

Приклади слабких ключів:
```
0101010101010101
FEFEFEFEFEFEFEFE
E0E0E0E0F1F1F1F1
1F1F1F1F0E0E0E0E
```

### 3. Аналіз ентропії

Для кожного раунду мережі Фейстеля обчислюється:
- **Ентропія появи біту 1** за формулою: `H = -p₀·log₂(p₀) - p₁·log₂(p₁)`
- Кількість одиниць та нулів у блоці
- Ймовірність появи біту 1

Результати відображаються у вигляді:
- Графіка зміни ентропії по раундах
- Таблиці з детальними даними

### 4. Графічний інтерфейс

GUI містить три вкладки:

**Шифрування/Розшифрування:**
- Поле для введення ключа (8 символів)
- Текстове поле для вхідних даних
- Кнопки шифрування/розшифрування
- Поле для відображення результату

**Аналіз ентропії:**
- Графік ентропії по раундах
- Таблиця з детальними даними (раунд, ентропія, одиниці, нулі, ймовірність)

**Інформація:**
- Опис алгоритму DES
- Пояснення слабких ключів
- Формула ентропії
- Інструкція з використання

---

## Технічна реалізація

### Основні компоненти алгоритму DES

#### 1. Перестановки

- **IP (Initial Permutation)** - початкова перестановка 64 біт
- **IP⁻¹ (Final Permutation)** - кінцева перестановка (обернена до IP)
- **E (Expansion)** - розширення з 32 до 48 біт
- **P (Permutation)** - перестановка після S-boxes

#### 2. Генерація раундових ключів

- **PC-1** - вибір 56 біт з 64-бітного ключа
- **PC-2** - вибір 48 біт для кожного раунду
- Циклічні зсуви на 1 або 2 біти залежно від раунду

#### 3. S-boxes (Substitution boxes)

8 таблиць підстановки, кожна:
- Приймає 6 біт на вході
- Повертає 4 біти на виході
- Використовує 2 біти для вибору рядка, 4 біти для вибору стовпця

#### 4. Функція шифрування f (мережа Фейстеля)

На кожному раунді:
```
1. Розширення R з 32 до 48 біт (E)
2. XOR з раундовим ключем
3. Підстановка через 8 S-boxes (48 → 32 біти)
4. Перестановка P
5. XOR з лівою половиною L
6. Обмін L і R
```

### Структура класу DES

```python
class DES:
    def __init__(self, key: bytes)
    def encrypt(self, plaintext: bytes) -> bytes
    def decrypt(self, ciphertext: bytes) -> bytes
    def get_last_round_entropies(self) -> List[dict]

    @staticmethod
    def is_weak_key(key: bytes) -> bool
```

### Обчислення ентропії

```python
def _calculate_entropy(bits: List[int]) -> float:
    ones = sum(bits)
    zeros = len(bits) - ones
    p1 = ones / len(bits)
    p0 = zeros / len(bits)

    entropy = 0.0
    if p0 > 0:
        entropy -= p0 * math.log2(p0)
    if p1 > 0:
        entropy -= p1 * math.log2(p1)

    return entropy
```

---

## Тестування

### Набір тестів

1. **Тест шифрування/розшифрування**
   - Перевірка на різних довжинах тексту
   - Перевірка на різних ключах
   - Перевірка коректності розшифрування

2. **Тест слабких ключів**
   - Виявлення всіх weak keys
   - Виявлення semi-weak keys
   - Відсутність false positives

3. **Тест обчислення ентропії**
   - Перевірка діапазону значень [0, 1]
   - Коректність обчислення для кожного раунду

### Результати тестування

```
ТЕСТУВАННЯ ШИФРУВАННЯ ТА РОЗШИФРУВАННЯ
✓ Тест 1: ПРОЙДЕНО
✓ Тест 2: ПРОЙДЕНО
✓ Тест 3: ПРОЙДЕНО
✓ Тест 4: ПРОЙДЕНО
Результати: 4 пройдено, 0 не пройдено

ТЕСТУВАННЯ ПЕРЕВІРКИ СЛАБКИХ КЛЮЧІВ
Виявлено 4 з 4 слабких ключів
Помилкових спрацювань: 0 з 4
✓ ТЕСТ ПРОЙДЕНО

ТЕСТУВАННЯ РОЗРАХУНКУ ЕНТРОПІЇ
✓ ТЕСТ ПРОЙДЕНО: всі значення ентропії в допустимому діапазоні [0, 1]
```

---

## Результати

### Приклад шифрування

**Ключ:** `DESCRYPT`
**Відкритий текст:** `Hello, DES!`
**Зашифрований (HEX):** `a818d6690cf43c5c0dce98f65fe68fe4`

### Приклад ентропії по раундах

| Раунд | Ентропія | Одиниць | Нулів | p(1)   |
|-------|----------|---------|-------|--------|
| 1     | 0.997180 | 15      | 17    | 0.4688 |
| 2     | 0.997180 | 15      | 17    | 0.4688 |
| 3     | 0.988699 | 14      | 18    | 0.4375 |
| ...   | ...      | ...     | ...   | ...    |
| 8     | 1.000000 | 16      | 16    | 0.5000 |
| ...   | ...      | ...     | ...   | ...    |
| 16    | 0.988699 | 18      | 14    | 0.5625 |

**Висновок:** Ентропія наближається до максимального значення (1.0), що свідчить про якісне перемішування даних у процесі шифрування.

---

## Важливі примітки

⚠️ **УВАГА:** Ця реалізація створена виключно для навчальних цілей!

- DES вважається **застарілим** алгоритмом з 2001 року
- 56-бітний ключ може бути зламаний методом повного перебору
- **НЕ використовуйте** DES для захисту реальних даних

**Сучасні альтернативи:**
- AES (Advanced Encryption Standard)
- ChaCha20
- 3DES (перехідний варіант)

---

## Використані джерела

1. FIPS PUB 46-3: Data Encryption Standard (DES)
2. Applied Cryptography by Bruce Schneier
3. Документація лабораторної роботи

---

## Автор

Студент НУРЕ
Курс: Безпека програмних та апаратних засобів
Рік: 2025

---

## Ліцензія

Цей проект створено для навчальних цілей.
