# –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞ —Ä–æ–±–æ—Ç–∞ ‚Ññ4: –ê–ª–≥–æ—Ä–∏—Ç–º –æ–±–º—ñ–Ω—É –∫–ª—é—á–∞–º–∏ –î—ñ—Ñ—Ñ—ñ-–•–µ–ª–ª–º–∞–Ω–∞

**–ó–∞—Ö–∏—â–µ–Ω–∏–π —á–∞—Ç –∑ —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è–º –Ω–∞ –æ—Å–Ω–æ–≤—ñ –î—ñ—Ñ—Ñ—ñ-–•–µ–ª–ª–º–∞–Ω–∞ —Ç–∞ AES-256**

## –û–ø–∏—Å –ø—Ä–æ–µ–∫—Ç—É

–†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è –±–∞–≥–∞—Ç–æ–∫–æ—Ä–∏—Å—Ç—É–≤–∞—Ü—å–∫–æ–≥–æ —á–∞—Ç—É –∑ –Ω–∞—Å–∫—Ä—ñ–∑–Ω–∏–º —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è–º, —â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î:
- **–ê–ª–≥–æ—Ä–∏—Ç–º –î—ñ—Ñ—Ñ—ñ-–•–µ–ª–ª–º–∞–Ω–∞** –¥–ª—è –±–µ–∑–ø–µ—á–Ω–æ–≥–æ –æ–±–º—ñ–Ω—É –∫–ª—é—á–∞–º–∏
- **AES-256-CBC** –¥–ª—è —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å
- **–ö–æ–Ω—Å–æ–ª—å–Ω–∏–π TUI —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å** –Ω–∞ –±–∞–∑—ñ –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏ `rich`
- **–ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä—É –∫–ª—ñ—î–Ω—Ç-—Å–µ—Ä–≤–µ—Ä** –∑ –≥—Ä—É–ø–æ–≤–∏–º –∫–ª—é—á–µ–º

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç—É

```
lab4/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ diffie_hellman.py  # –†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è –∞–ª–≥–æ—Ä–∏—Ç–º—É –î—ñ—Ñ—Ñ—ñ-–•–µ–ª–ª–º–∞–Ω–∞
‚îÇ   ‚îú‚îÄ‚îÄ crypto_utils.py    # AES —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è/–¥–µ—à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è
‚îÇ   ‚îú‚îÄ‚îÄ utils.py           # –î–æ–ø–æ–º—ñ–∂–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó –¥–ª—è –º–µ—Ä–µ–∂—ñ
‚îÇ   ‚îú‚îÄ‚îÄ server.py          # –°–µ—Ä–≤–µ—Ä —á–∞—Ç—É
‚îÇ   ‚îî‚îÄ‚îÄ client.py          # –ö–ª—ñ—î–Ω—Ç –∑ TUI —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º
‚îú‚îÄ‚îÄ docs/
‚îÇ   ‚îî‚îÄ‚îÄ –õ–† ‚Ññ4.pdf         # –ú–µ—Ç–æ–¥–∏—á–Ω—ñ –≤–∫–∞–∑—ñ–≤–∫–∏
‚îú‚îÄ‚îÄ requirements.txt       # –ó–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ Python
‚îú‚îÄ‚îÄ run_server.py         # –°–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å–∫—É —Å–µ—Ä–≤–µ—Ä–∞
‚îú‚îÄ‚îÄ run_client.py         # –°–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å–∫—É –∫–ª—ñ—î–Ω—Ç–∞
‚îî‚îÄ‚îÄ README.md             # –¶—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è
```

## –¢–µ–æ—Ä–µ—Ç–∏—á–Ω–∞ –æ—Å–Ω–æ–≤–∞

### –ê–ª–≥–æ—Ä–∏—Ç–º –î—ñ—Ñ—Ñ—ñ-–•–µ–ª–ª–º–∞–Ω–∞

–ê–ª–≥–æ—Ä–∏—Ç–º –¥–æ–∑–≤–æ–ª—è—î –¥–≤–æ–º –∞–±–æ –±—ñ–ª—å—à–µ —Å—Ç–æ—Ä–æ–Ω–∞–º –±–µ–∑–ø–µ—á–Ω–æ –æ–±–º—ñ–Ω—è—Ç–∏—Å—è –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ—ñ—á–Ω–∏–º–∏ –∫–ª—é—á–∞–º–∏ —á–µ—Ä–µ–∑ –Ω–µ–∑–∞—Ö–∏—â–µ–Ω–∏–π –∫–∞–Ω–∞–ª –∑–≤'—è–∑–∫—É.

**–ü—É–±–ª—ñ—á–Ω—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏:**
- `Q` ‚Äî –ø—Ä–æ—Å—Ç–µ —á–∏—Å–ª–æ (prime)
- `A` ‚Äî –ø—Ä–∏–º—ñ—Ç–∏–≤–Ω–∏–π –∫–æ—Ä—ñ–Ω—å Q (primitive root)

**–î–ª—è –∫–æ–∂–Ω–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞:**
- `X` ‚Äî –ø—Ä–∏–≤–∞—Ç–Ω–∏–π –∫–ª—é—á (–≤–∏–ø–∞–¥–∫–æ–≤–µ —á–∏—Å–ª–æ, X < Q)
- `Y` ‚Äî –ø—É–±–ª—ñ—á–Ω–∏–π –∫–ª—é—á (Y = A^X mod Q)

**–û–±—á–∏—Å–ª–µ–Ω–Ω—è —Å–ø—ñ–ª—å–Ω–æ–≥–æ –∫–ª—é—á–∞:**
- –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á B –æ–±—á–∏—Å–ª—é—î: `K = Y_C^X_B mod Q`
- –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á C –æ–±—á–∏—Å–ª—é—î: `K = Y_B^X_C mod Q`
- –†–µ–∑—É–ª—å—Ç–∞—Ç: `K_B = K_C` (–æ–±–∏–¥–≤–∞ –æ—Ç—Ä–∏–º—É—é—Ç—å –æ–¥–Ω–∞–∫–æ–≤–∏–π –∫–ª—é—á)

### –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º–∏

1. **–°–µ—Ä–≤–µ—Ä** –≥–µ–Ω–µ—Ä—É—î –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ DH (Q, A) —Ç–∞ —Å–≤–æ—é –ø–∞—Ä—É –∫–ª—é—á—ñ–≤
2. **–ö–ª—ñ—î–Ω—Ç** –ø—ñ–¥–∫–ª—é—á–∞—î—Ç—å—Å—è —Ç–∞ –æ—Ç—Ä–∏–º—É—î –ø–∞—Ä–∞–º–µ—Ç—Ä–∏
3. **–ö–ª—ñ—î–Ω—Ç** –≥–µ–Ω–µ—Ä—É—î —Å–≤–æ—é –ø–∞—Ä—É –∫–ª—é—á—ñ–≤ —ñ –≤—ñ–¥–ø—Ä–∞–≤–ª—è—î –ø—É–±–ª—ñ—á–Ω–∏–π –∫–ª—é—á
4. **–û–±–∏–¥–≤—ñ —Å—Ç–æ—Ä–æ–Ω–∏** –æ–±—á–∏—Å–ª—é—é—Ç—å –ø–æ–ø–∞—Ä–Ω–∏–π —Å–µ—Å—ñ–π–Ω–∏–π –∫–ª—é—á
5. **–°–µ—Ä–≤–µ—Ä** –≥–µ–Ω–µ—Ä—É—î –≥—Ä—É–ø–æ–≤–∏–π –∫–ª—é—á —Ç–∞ –Ω–∞–¥—Å–∏–ª–∞—î –π–æ–≥–æ –∫–ª—ñ—î–Ω—Ç—É, –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–º —Å–µ—Å—ñ–π–Ω–∏–º –∫–ª—é—á–µ–º
6. **–í—Å—ñ –∫–ª—ñ—î–Ω—Ç–∏** –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å –≥—Ä—É–ø–æ–≤–∏–π –∫–ª—é—á –¥–ª—è —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é AES-256

## –í–∏–º–æ–≥–∏

- Python 3.7+
- –ë—ñ–±–ª—ñ–æ—Ç–µ–∫–∏:
  - `cryptography` ‚Äî –¥–ª—è AES —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è
  - `rich` ‚Äî –¥–ª—è TUI —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É

## –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è

### 1. –ö–ª–æ–Ω—É–≤–∞–Ω–Ω—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é

```bash
cd /home/sasha/nure/BPTD-SoftwareAndDataSecurity/lab4
```

### 2. –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π

```bash
pip install -r requirements.txt
```

–∞–±–æ

```bash
pip install cryptography rich
```

## –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

### –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞

–£ –ø–µ—Ä—à–æ–º—É —Ç–µ—Ä–º—ñ–Ω–∞–ª—ñ:

```bash
python run_server.py
```

–∞–±–æ

```bash
python3 run_server.py
```

–°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å—Ç–∏—Ç—å—Å—è –Ω–∞ –ø–æ—Ä—Ç—É **5555** —ñ –±—É–¥–µ –æ—á—ñ–∫—É–≤–∞—Ç–∏ –ø—ñ–¥–∫–ª—é—á–µ–Ω—å.

**–ü—Ä–∏–∫–ª–∞–¥ –≤–∏–≤–æ–¥—É:**
```
============================================================
  –°–ï–†–í–ï–† –ß–ê–¢–£ –ó –®–ò–§–†–£–í–ê–ù–ù–Ø–ú –î–Ü–§–§–Ü-–•–ï–õ–õ–ú–ê–ù–ê + AES
  –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞ —Ä–æ–±–æ—Ç–∞ ‚Ññ4
============================================================
[*] –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ –î—ñ—Ñ—Ñ—ñ-–•–µ–ª–ª–º–∞–Ω–∞ (512 –±—ñ—Ç)...
[+] –ü–∞—Ä–∞–º–µ—Ç—Ä–∏ DH –∑–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω–æ:
    Q (–ø—Ä–æ—Å—Ç–µ —á–∏—Å–ª–æ) = 123456...
    A (–ø—Ä–∏–º—ñ—Ç–∏–≤–Ω–∏–π –∫–æ—Ä—ñ–Ω—å) = 2
    –ü—É–±–ª—ñ—á–Ω–∏–π –∫–ª—é—á —Å–µ—Ä–≤–µ—Ä–∞ = 789012...
[+] –ì—Ä—É–ø–æ–≤–∏–π –∫–ª—é—á –∑–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω–æ: a1b2c3d4...

[+] –°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω–æ –Ω–∞ 0.0.0.0:5555
[*] –û—á—ñ–∫—É–≤–∞–Ω–Ω—è –ø—ñ–¥–∫–ª—é—á–µ–Ω—å –∫–ª—ñ—î–Ω—Ç—ñ–≤...
```

### –ó–∞–ø—É—Å–∫ –∫–ª—ñ—î–Ω—Ç–∞

–£ –Ω–∞—Å—Ç—É–ø–Ω–∏—Ö —Ç–µ—Ä–º—ñ–Ω–∞–ª–∞—Ö (–º—ñ–Ω—ñ–º—É–º 3 –¥–ª—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è):

**–ü—Ä–æ—Å—Ç–∏–π –∫–ª—ñ—î–Ω—Ç:**
```bash
python run_client.py
```

**–ü–æ–∫—Ä–∞—â–µ–Ω–∏–π –∫–ª—ñ—î–Ω—Ç –∑ TUI (—Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ):**
```bash
python run_client_improved.py
```

**–ö—Ä–æ–∫–∏ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è:**
1. –í–≤–µ–¥—ñ—Ç—å –∞–¥—Ä–µ—Å—É —Å–µ—Ä–≤–µ—Ä–∞ (–∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º: `127.0.0.1`)
2. –í–≤–µ–¥—ñ—Ç—å –ø–æ—Ä—Ç (–∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º: `5555`)
3. –í–≤–µ–¥—ñ—Ç—å —Å–≤–æ—î —ñ–º'—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
4. –°–ø–æ—Å—Ç–µ—Ä—ñ–≥–∞–π—Ç–µ –∑–∞ –ø—Ä–æ—Ü–µ—Å–æ–º –æ–±–º—ñ–Ω—É –∫–ª—é—á–∞–º–∏
5. –ù–∞—Å–æ–ª–æ–¥–∂—É–π—Ç–µ—Å—å –∑–∞—Ö–∏—â–µ–Ω–∏–º —á–∞—Ç–æ–º!

**–Ü–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∫–ª—ñ—î–Ω—Ç–∞:**
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ         –ó–∞—Ö–∏—â–µ–Ω–∏–π —á–∞—Ç - Alice                      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ üí¨ –ß–∞—Ç                  ‚îÇ üë• –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ (3)       ‚îÇ
‚îÇ                         ‚îÇ üë§ Alice (–≤–∏)            ‚îÇ
‚îÇ [12:30:45] ‚Ä¢ Alice      ‚îÇ üë§ Bob                   ‚îÇ
‚îÇ   –ø—Ä–∏—î–¥–Ω–∞–≤—Å—è            ‚îÇ üë§ Charlie               ‚îÇ
‚îÇ                         ‚îÇ                          ‚îÇ
‚îÇ [12:31:00] Bob:         ‚îÇ ‚ÑπÔ∏è  –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è           ‚îÇ
‚îÇ   –ü—Ä–∏–≤—ñ—Ç –≤—Å—ñ–º!          ‚îÇ üîê –®–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è:           ‚îÇ
‚îÇ                         ‚îÇ    AES-256-CBC           ‚îÇ
‚îÇ [12:31:15] Alice:       ‚îÇ üîë –ì—Ä—É–ø–æ–≤–∏–π –∫–ª—é—á:        ‚îÇ
‚îÇ   –ü—Ä–∏–≤—ñ—Ç, Bob!          ‚îÇ    a1b2c3d4e5f6...       ‚îÇ
‚îÇ                         ‚îÇ üì° –°–µ—Ä–≤–µ—Ä:               ‚îÇ
‚îÇ                         ‚îÇ    127.0.0.1:5555        ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –í–≤–µ–¥—ñ—Ç—å –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –∞–±–æ /quit –¥–ª—è –≤–∏—Ö–æ–¥—É          ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –ö–æ–º–∞–Ω–¥–∏ –∫–ª—ñ—î–Ω—Ç–∞

- –í–≤–µ–¥—ñ—Ç—å —Ç–µ–∫—Å—Ç —ñ –Ω–∞—Ç–∏—Å–Ω—ñ—Ç—å Enter –¥–ª—è –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
- `/quit` ‚Äî –≤–∏–π—Ç–∏ –∑ —á–∞—Ç—É

## –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –º–æ–¥—É–ª—ñ–≤

### –¢–µ—Å—Ç –î—ñ—Ñ—Ñ—ñ-–•–µ–ª–ª–º–∞–Ω–∞

```bash
cd src
python diffie_hellman.py
```

–í–∏–≤—ñ–¥ –ø–æ–∫–∞–∂–µ –ø—Ä–æ—Ü–µ—Å –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó –∫–ª—é—á—ñ–≤ —Ç–∞ –æ–±–º—ñ–Ω—É –º—ñ–∂ –¥–≤–æ–º–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º–∏.

### –¢–µ—Å—Ç AES —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è

```bash
cd src
python crypto_utils.py
```

–í–∏–≤—ñ–¥ –ø–æ–∫–∞–∂–µ –ø—Ä–æ—Ü–µ—Å —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è —Ç–∞ –¥–µ—à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è —Ç–µ—Å—Ç–æ–≤–∏—Ö –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å.

### –¢–µ—Å—Ç —É—Ç–∏–ª—ñ—Ç

```bash
cd src
python utils.py
```

## –û—Å–æ–±–ª–∏–≤–æ—Å—Ç—ñ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó

### –ë–µ–∑–ø–µ–∫–∞

1. **–î—ñ—Ñ—Ñ—ñ-–•–µ–ª–ª–º–∞–Ω:**
   - –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è –ø—Ä–æ—Å—Ç—ñ —á–∏—Å–ª–∞ —Ä–æ–∑—Ä—è–¥–Ω–æ—Å—Ç—ñ 512 –±—ñ—Ç (–º–æ–∂–Ω–∞ –∑–±—ñ–ª—å—à–∏—Ç–∏ –¥–ª—è –ø–æ—Å–∏–ª–µ–Ω–æ—ó –±–µ–∑–ø–µ–∫–∏)
   - –ü—Ä–∏–º—ñ—Ç–∏–≤–Ω—ñ –∫–æ—Ä–µ–Ω—ñ –æ–±—á–∏—Å–ª—é—é—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ
   - –ü—Ä–∏–≤–∞—Ç–Ω—ñ –∫–ª—é—á—ñ –≥–µ–Ω–µ—Ä—É—é—Ç—å—Å—è –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ—ñ—á–Ω–æ –±–µ–∑–ø–µ—á–Ω–∏–º –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–æ–º `secrets`

2. **AES-256:**
   - –†–µ–∂–∏–º CBC –∑ –≤–∏–ø–∞–¥–∫–æ–≤–∏–º –≤–µ–∫—Ç–æ—Ä–æ–º —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—ó (IV) –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
   - PKCS7 padding –¥–ª—è –≤–∏—Ä—ñ–≤–Ω—é–≤–∞–Ω–Ω—è –±–ª–æ–∫—ñ–≤
   - –ì—Ä—É–ø–æ–≤–∏–π –∫–ª—é—á 256 –±—ñ—Ç (32 –±–∞–π—Ç–∏)

3. **–ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞:**
   - –ü–æ–ø–∞—Ä–Ω–∏–π DH –æ–±–º—ñ–Ω –º—ñ–∂ —Å–µ—Ä–≤–µ—Ä–æ–º —ñ –∫–æ–∂–Ω–∏–º –∫–ª—ñ—î–Ω—Ç–æ–º
   - –ì—Ä—É–ø–æ–≤–∏–π –∫–ª—é—á –±–µ–∑–ø–µ—á–Ω–æ —Ä–æ–∑–ø–æ–¥—ñ–ª—è—î—Ç—å—Å—è —á–µ—Ä–µ–∑ —Å–µ—Å—ñ–π–Ω—ñ –∫–ª—é—á—ñ
   - –í—Å—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è —à–∏—Ñ—Ä—É—é—Ç—å—Å—è –Ω–∞ —Å—Ç–æ—Ä–æ–Ω—ñ –∫–ª—ñ—î–Ω—Ç–∞

### –ü—Ä–æ—Ç–æ–∫–æ–ª –æ–±–º—ñ–Ω—É

**–ï—Ç–∞–ø 1: –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è —Ç–∞ DH –æ–±–º—ñ–Ω**
```
–ö–ª—ñ—î–Ω—Ç                    –°–µ—Ä–≤–µ—Ä
  |                         |
  |-------- connect ------->|
  |<--- Q, A, Y_server ------|
  |                         |
  |--- username, Y_client ->|
  |                         |
```

**–ï—Ç–∞–ø 2: –†–æ–∑–ø–æ–¥—ñ–ª –≥—Ä—É–ø–æ–≤–æ–≥–æ –∫–ª—é—á–∞**
```
–ö–ª—ñ—î–Ω—Ç                    –°–µ—Ä–≤–µ—Ä
  |                         |
  | (–æ–±—á–∏—Å–ª—é—î K_session)    | (–æ–±—á–∏—Å–ª—é—î K_session)
  |<- Encrypt_K(K_group) ---|
  | (–¥–µ—à–∏—Ñ—Ä—É—î K_group)      |
  |                         |
```

**–ï—Ç–∞–ø 3: –û–±–º—ñ–Ω –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è–º–∏**
```
–ö–ª—ñ—î–Ω—Ç A                  –°–µ—Ä–≤–µ—Ä                  –ö–ª—ñ—î–Ω—Ç B
  |                         |                         |
  |-- Encrypt_Kg(msg) ----->|                         |
  |                         |---- Encrypt_Kg(msg) --->|
  |                         |                         |
```

## –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ñ –ø–∏—Ç–∞–Ω–Ω—è (–∑ –º–µ—Ç–æ–¥–∏—á–∫–∏)

### 1. –î–ª—è —á–æ–≥–æ —Å—Ç–≤–æ—Ä–µ–Ω—ñ –∞–ª–≥–æ—Ä–∏—Ç–º–∏ –æ–±–º—ñ–Ω—É –∫–ª—é—á–∞–º–∏?

–ê–ª–≥–æ—Ä–∏—Ç–º–∏ –æ–±–º—ñ–Ω—É –∫–ª—é—á–∞–º–∏ –ø—Ä–∏–∑–Ω–∞—á–µ–Ω—ñ –¥–ª—è –±–µ–∑–ø–µ—á–Ω–æ–≥–æ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —Å–ø—ñ–ª—å–Ω–æ–≥–æ —Å–µ–∫—Ä–µ—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞ –º—ñ–∂ —Å—Ç–æ—Ä–æ–Ω–∞–º–∏ —á–µ—Ä–µ–∑ –Ω–µ–∑–∞—Ö–∏—â–µ–Ω–∏–π –∫–∞–Ω–∞–ª –∑–≤'—è–∑–∫—É. –¶–µ–π –∫–ª—é—á –Ω–∞–¥–∞–ª—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –≤ —Å–∏–º–µ—Ç—Ä–∏—á–Ω–∏—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–∞—Ö —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è (—Ç–∞–∫–∏—Ö —è–∫ AES) –¥–ª—è –∑–∞—Ö–∏—Å—Ç—É –¥–∞–Ω–∏—Ö.

### 2. –©–æ –º–∞—î—Ç—å—Å—è –Ω–∞ —É–≤–∞–∑—ñ –ø—ñ–¥ –ø–æ–Ω—è—Ç—Ç—è–º –ø—Ä–∏–º—ñ—Ç–∏–≤–Ω–æ–≥–æ –∫–æ—Ä–µ–Ω—è –ø—Ä–æ—Å—Ç–æ–≥–æ —á–∏—Å–ª–∞?

–ü—Ä–∏–º—ñ—Ç–∏–≤–Ω–∏–π –∫–æ—Ä—ñ–Ω—å A –ø—Ä–æ—Å—Ç–æ–≥–æ —á–∏—Å–ª–∞ Q ‚Äî —Ü–µ —Ç–∞–∫–µ —á–∏—Å–ª–æ, —â–æ –π–æ–≥–æ —Å—Ç–µ–ø–µ–Ω—ñ {A¬π, A¬≤, ..., A^(Q-1)} mod Q –≥–µ–Ω–µ—Ä—É—é—Ç—å –≤—Å—ñ —Ü—ñ–ª—ñ —á–∏—Å–ª–∞ –≤—ñ–¥ 1 –¥–æ Q-1 –≤ –¥–µ—è–∫—ñ–π –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤—Ü—ñ. –Ü–Ω—à–∏–º–∏ —Å–ª–æ–≤–∞–º–∏, A —î –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–æ–º –º—É–ª—å—Ç–∏–ø–ª—ñ–∫–∞—Ç–∏–≤–Ω–æ—ó –≥—Ä—É–ø–∏ –ø–æ –º–æ–¥—É–ª—é Q.

### 3. –Ø–∫ —Å—Ç–≤–æ—Ä—é—é—Ç—å—Å—è –ø–∞—Ä–∏ –∫–ª—é—á—ñ–≤ –¥–ª—è –æ–±–æ—Ö —Å—Ç–æ—Ä—ñ–Ω?

–î–ª—è –∫–æ–∂–Ω–æ—ó —Å—Ç–æ—Ä–æ–Ω–∏:
1. –ì–µ–Ω–µ—Ä—É—î—Ç—å—Å—è –≤–∏–ø–∞–¥–∫–æ–≤–∏–π –ø—Ä–∏–≤–∞—Ç–Ω–∏–π –∫–ª—é—á X (2 ‚â§ X ‚â§ Q-2)
2. –û–±—á–∏—Å–ª—é—î—Ç—å—Å—è –ø—É–±–ª—ñ—á–Ω–∏–π –∫–ª—é—á: Y = A^X mod Q
3. –ü—É–±–ª—ñ—á–Ω–∏–π –∫–ª—é—á Y –ø–µ—Ä–µ–¥–∞—î—Ç—å—Å—è —ñ–Ω—à—ñ–π —Å—Ç–æ—Ä–æ–Ω—ñ
4. –ü—Ä–∏–≤–∞—Ç–Ω–∏–π –∫–ª—é—á X –∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è –≤ —Å–µ–∫—Ä–µ—Ç—ñ

### 4. –ó —á–æ–≥–æ –≤–∏—Ö–æ–¥–∏—Ç—å, —â–æ –æ–±–º—ñ–Ω –∫–ª—é—á–∞–º–∏ –ø–æ –∞–ª–≥–æ—Ä–∏—Ç–º—É –î—ñ—Ñ—Ñ—ñ-–•–µ–ª–ª–º–∞–Ω–∞ –≤–≤–∞–∂–∞—î—Ç—å—Å—è –±–µ–∑–ø–µ—á–Ω–∏–º?

–ë–µ–∑–ø–µ–∫–∞ –±–∞–∑—É—î—Ç—å—Å—è –Ω–∞ —Å–∫–ª–∞–¥–Ω–æ—Å—Ç—ñ –∑–∞–¥–∞—á—ñ –¥–∏—Å–∫—Ä–µ—Ç–Ω–æ–≥–æ –ª–æ–≥–∞—Ä–∏—Ñ–º—É–≤–∞–Ω–Ω—è. –ê—Ç–∞–∫—É—é—á–∏–π, –ø–µ—Ä–µ—Ö–æ–ø–∏–≤—à–∏ –ø—É–±–ª—ñ—á–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è Q, A, Y_B —Ç–∞ Y_C, –Ω–µ –º–æ–∂–µ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –æ–±—á–∏—Å–ª–∏—Ç–∏ –ø—Ä–∏–≤–∞—Ç–Ω—ñ –∫–ª—é—á—ñ X_B –∞–±–æ X_C, –∞ –æ—Ç–∂–µ —ñ —Å–ø—ñ–ª—å–Ω–∏–π —Å–µ–∫—Ä–µ—Ç–Ω–∏–π –∫–ª—é—á K. –î–ª—è –≤–µ–ª–∏–∫–∏—Ö –ø—Ä–æ—Å—Ç–∏—Ö —á–∏—Å–µ–ª (2048+ –±—ñ—Ç) —Ü—è –∑–∞–¥–∞—á–∞ –≤–≤–∞–∂–∞—î—Ç—å—Å—è –æ–±—á–∏—Å–ª—é–≤–∞–ª—å–Ω–æ –Ω–µ—Ä–æ–∑–≤'—è–∑–Ω–æ—é.

### 5. –©–æ —Ç–∞–∫–µ –∞—Ç–∞–∫–∞ —Ç–∏–ø—É "man-in-the-middle"?

–ê—Ç–∞–∫–∞ "–ª—é–¥–∏–Ω–∞ –ø–æ—Å–µ—Ä–µ–¥–∏–Ω—ñ" (MITM) ‚Äî —Ü–µ –∞–∫—Ç–∏–≤–Ω–∞ –∞—Ç–∞–∫–∞, –∫–æ–ª–∏ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫:
1. –ü–µ—Ä–µ—Ö–æ–ø–ª—é—î –ø—É–±–ª—ñ—á–Ω—ñ –∫–ª—é—á—ñ —É—á–∞—Å–Ω–∏–∫—ñ–≤ (Y_B —Ç–∞ Y_C)
2. –ì–µ–Ω–µ—Ä—É—î –≤–ª–∞—Å–Ω—É –ø–∞—Ä—É –∫–ª—é—á—ñ–≤
3. –ù–∞–¥—Å–∏–ª–∞—î —Å–≤—ñ–π –ø—É–±–ª—ñ—á–Ω–∏–π –∫–ª—é—á –∫–æ–∂–Ω–æ–º—É —É—á–∞—Å–Ω–∏–∫—É, –≤–∏–¥–∞—é—á–∏ —Å–µ–±–µ –∑–∞ —ñ–Ω—à–æ–≥–æ
4. –í—Å—Ç–∞–Ω–æ–≤–ª—é—î –¥–≤–∞ –æ–∫—Ä–µ–º—ñ "–±–µ–∑–ø–µ—á–Ω—ñ" –∑'—î–¥–Ω–∞–Ω–Ω—è (–∑ B —Ç–∞ –∑ C)
5. –î–µ—à–∏—Ñ—Ä—É—î, —á–∏—Ç–∞—î —Ç–∞ –ø–µ—Ä–µ—à–∏—Ñ—Ä–æ–≤—É—î –≤—Å—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è

**–ó–∞—Ö–∏—Å—Ç:** –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó, —Ü–∏—Ñ—Ä–æ–≤–∏—Ö –ø—ñ–¥–ø–∏—Å—ñ–≤ –∞–±–æ —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç—ñ–≤ –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ —ñ–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç—ñ —É—á–∞—Å–Ω–∏–∫—ñ–≤.

## –ú–æ–∂–ª–∏–≤—ñ –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è

1. **–ü–æ—Å–∏–ª–µ–Ω–∞ –±–µ–∑–ø–µ–∫–∞:**
   - –ó–±—ñ–ª—å—à–µ–Ω–Ω—è —Ä–æ–∑—Ä—è–¥–Ω–æ—Å—Ç—ñ –ø—Ä–æ—Å—Ç–∏—Ö —á–∏—Å–µ–ª –¥–æ 2048-4096 –±—ñ—Ç
   - –î–æ–¥–∞–≤–∞–Ω–Ω—è —Ü–∏—Ñ—Ä–æ–≤–∏—Ö –ø—ñ–¥–ø–∏—Å—ñ–≤ –¥–ª—è –∑–∞—Ö–∏—Å—Ç—É –≤—ñ–¥ MITM
   - –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –µ–ª—ñ–ø—Ç–∏—á–Ω–∏—Ö –∫—Ä–∏–≤–∏—Ö (ECDH)

2. **–§—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å:**
   - –ü—Ä–∏–≤–∞—Ç–Ω—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –º—ñ–∂ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º–∏
   - –Ü—Å—Ç–æ—Ä—ñ—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å
   - –ü–µ—Ä–µ–¥–∞—á–∞ —Ñ–∞–π–ª—ñ–≤

3. **–Ü–Ω—Ç–µ—Ä—Ñ–µ–π—Å:**
   - Web-—ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å
   - GUI –Ω–∞ Qt/Tkinter
   - –ú–æ–±—ñ–ª—å–Ω—ñ –∫–ª—ñ—î–Ω—Ç–∏

## –ê–≤—Ç–æ—Ä

–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞ —Ä–æ–±–æ—Ç–∞ –≤–∏–∫–æ–Ω–∞–Ω–∞ –≤ —Ä–∞–º–∫–∞—Ö –∫—É—Ä—Å—É "–ë–µ–∑–ø–µ–∫–∞ –ø—Ä–æ–≥—Ä–∞–º–Ω–æ–≥–æ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è —Ç–∞ –¥–∞–Ω–∏—Ö"

## –õ—ñ—Ü–µ–Ω–∑—ñ—è

–ù–∞–≤—á–∞–ª—å–Ω–∏–π –ø—Ä–æ–µ–∫—Ç

## –î–æ–¥–∞—Ç–∫–æ–≤—ñ —Ä–µ—Å—É—Ä—Å–∏

- [–î—ñ—Ñ—Ñ—ñ-–•–µ–ª–ª–º–∞–Ω –Ω–∞ Wikipedia](https://uk.wikipedia.org/wiki/–ü—Ä–æ—Ç–æ–∫–æ–ª_–î—ñ—Ñ—Ñ—ñ_‚Äî_–•–µ–ª–ª–º–∞–Ω–∞)
- [AES –Ω–∞ Wikipedia](https://uk.wikipedia.org/wiki/Advanced_Encryption_Standard)
- [Cryptography library documentation](https://cryptography.io/)
- [Rich library documentation](https://rich.readthedocs.io/)
