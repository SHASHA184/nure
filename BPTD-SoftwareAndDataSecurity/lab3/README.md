# Лабораторна робота №3: Програмна реалізація хеш-функцій

**Курс:** Безпека програмного забезпечення та даних
**Університет:** НУРЕ (Національний університет радіоелектроніки)

## Мета роботи

Ознайомитись з можливостями криптографічних хеш-функцій при організації контроля цілісності цифрових об'єктів та отримати навички їх використання.

## Реалізовані завдання

✅ **Завдання 1:** Розроблено власну хеш-функцію з підтримкою 2, 4, 8 біт
✅ **Завдання 2:** Створено три тестові документа (Word, Python код, зображення)
✅ **Завдання 3:** Реалізовано обчислення дайджесту для всіх типів файлів
✅ **Завдання 4:** Створено колізії шляхом зміни метаданих файлів
✅ **Завдання 5:** Реалізовано програму автоматичної генерації колізій

## Структура проекту

```
lab3/
├── src/
│   ├── hash_function.py      # Власна хеш-функція
│   ├── file_processor.py     # Обробка файлів
│   ├── collision_maker.py    # Генерація колізій
│   └── main.py              # CLI інтерфейс
├── test_files/              # Тестові файли
│   ├── document.docx
│   ├── document_collision.docx
│   ├── source_code.py
│   ├── source_code_collision.py
│   ├── image.png
│   └── image_collision.png
├── docs/                    # Документація
├── requirements.txt         # Залежності
└── README.md               # Цей файл
```

## Встановлення

```bash
# Встановити залежності
pip install -r requirements.txt
```

## Використання

### 1. Обчислення хешу файлу

```bash
# Обчислити 8-бітний хеш
python src/main.py hash test_files/document.docx --bits 8

# Обчислити 2-бітний хеш
python src/main.py hash test_files/source_code.py --bits 2
```

### 2. Обчислити хеші для всіх тестових файлів

```bash
# 2-бітні хеші
python src/main.py hash-all --bits 2

# 4-бітні хеші
python src/main.py hash-all --bits 4

# 8-бітні хеші
python src/main.py hash-all --bits 8
```

### 3. Порівняння двох файлів

```bash
python src/main.py compare test_files/source_code.py test_files/source_code_collision.py --bits 2
```

### 4. Автоматична генерація колізії

```bash
# Створити колізію для файлу
python src/main.py collision test_files/source_code.py --bits 2 --verify

# З більшою кількістю спроб
python src/main.py collision test_files/image.png --bits 2 --max-attempts 10000 --verify
```

### 5. Тестування ефекту перемішування (Avalanche Effect)

```bash
# Перевірити властивість перемішування
python src/main.py avalanche test_files/source_code.py --num-tests 200
```

### 6. Обробка всіх файлів у директорії

```bash
python src/main.py process-dir test_files --bits 8
```

## Опис реалізації

### Хеш-функція

Власна хеш-функція реалізована з наступними характеристиками:

- **Підтримка розмірів:** 2, 4, 8 біт
- **Властивість перемішування:** При зміні будь-якого байту змінюється ≥50% бітів результату (вимога: ≥30%)
- **Алгоритм:** Використовує множинні раунди перемішування з XOR, обертанням бітів, та нелінійними операціями

#### Тест avalanche effect:

```
2-bit hash: 51.50% bits change on average ✓
4-bit hash: 49.12% bits change on average ✓
8-bit hash: 51.69% bits change on average ✓
```

### Генерація колізій

Автоматична генерація колізій реалізована через зміну метаданих файлів:

- **Word документи (.docx):** Зміна властивостей (comments, subject, keywords)
- **Зображення (.png):** Додавання метаданих (Comment, Author, Software)
- **Код (.py, .js, etc.):** Додавання невидимих коментарів

Ці зміни **не видимі неозброєним оком** при перегляді файлу, але змінюють його хеш-суму.

## Результати

### Обчислені хеші (2-біт)

| Файл | Розмір | Хеш | Двійковий |
|------|--------|-----|-----------|
| document.docx | 37160 bytes | 2 | 10 |
| source_code.py | 728 bytes | 2 | 10 |
| image.png | 4725 bytes | 0 | 00 |

### Створені колізії

| Оригінал | Колізія | Хеш | Успішна колізія |
|----------|---------|-----|-----------------|
| source_code.py | source_code_collision.py | 2 (10) | ✓ |
| image.png | image_collision.png | 0 (00) | ✓ |
| document.docx | document_collision.docx | 2 (10) | ✓ |

Всі колізії успішно створені - файли мають різний вміст, але однакову хеш-суму.

## Технології

- **Python 3.10+**
- **python-docx** - Робота з Word документами
- **Pillow** - Робота з зображеннями
- **argparse** - CLI інтерфейс

## Висновки

1. Реалізовано власну хеш-функцію з підтримкою різних розмірів вихідного значення (2, 4, 8 біт)
2. Хеш-функція задовольняє вимогу про зміну ≥30% бітів при зміні вхідних даних (фактично ~50%)
3. Програма вміє обчислювати хеші для різних типів файлів (документи, код, зображення)
4. Реалізовано автоматичну генерацію колізій через зміну метаданих файлів
5. Колізії створюються "невидимим" способом - зміни не помітні при звичайному перегляді файлів
6. Для малих розмірів хешу (2 біти) колізії знаходяться дуже швидко (< 10 спроб)

## Автор

Студент НУРЕ
Курс: Безпека програмного забезпечення та даних
